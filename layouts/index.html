{{ define "main" }}
<main id="home" class="home">

  <!-- >>> START HERO SECTION -->
  <section
    class="hero has-hero-bg"
    data-bg="{{ ("images/bg_image.webp" | absURL) }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
    aria-label="Hero EventHorizon.mtg"
  >
    <div class="hero__content">
      <!-- >>> START HERO LOGO -->
      <img class="hero__logo"
           src="{{ ("images/logo.webp" | absURL) }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
           alt="Logo {{ .Site.Title }}"
           width="115" height="115"
           decoding="async"
           fetchpriority="high" />
      <!-- <<< END HERO LOGO -->

      <!-- Text hero -->
      <h1 class="hero__title">BEYOND THE HORIZON</h1>
      <p class="hero__subtitle">
        Narrativa e mazzi Commander. 
        <br>Tutto su un'unica rotta!
      </p>
      <!-- CTA: 3 chevron a "V" animate -->
      <a class="hero-cta hero-cta--chevrons" href="#portal" aria-label="Scorri alla sezione successiva">
        <svg class="v" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6"/></svg>
        <svg class="v" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6"/></svg>
        <svg class="v" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6"/></svg>
      </a>
    </div>
  </section>
  <!-- <<< END HERO -->

  <!-- >>> START SUB-HERO (Pager) -->
  <section id="subhero" class="sub-hero" aria-roledescription="carousel" aria-label="Contenuti in evidenza">
    <div class="pager__viewport">
      <div class="pager__track">

        <!-- Slide 1 -->
        <article class="pager__slide slide-1 is-active" id="slide-1"
                 role="group" aria-roledescription="slide"
                 aria-label="Slide 1 di 3: Decklist"
                 data-bg-mobile="{{ "images/subhero/sh1-mobile.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
                 data-bg-desktop="{{ "images/subhero/sh1-desktop.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}">
          <h2 class="slide__title">LE NOSTRE DECKLIST!</h2>
          <p class="slide__desc">
            Create con tanta passione.<br>
            Scoprile su Moxfield e trova l'ispirazione!
          </p>
          <div class="slide__cta">
            <a class="btn btn--alphab" 
               target="_blank" rel="noopener noreferrer"
               href="https://moxfield.com/users/EventHorizonMtG">Moxfield</a>
          </div>
        </article>

        <!-- Slide 2 -->
        <article class="pager__slide slide-2" id="slide-2"
                 role="group" aria-roledescription="slide"
                 aria-label="Slide 2 di 3: Wiki ITA"
                 data-bg-mobile="{{ "images/subhero/sh2-mobile.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
                 data-bg-desktop="{{ "images/subhero/sh2-desktop.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}">
          <h2 class="slide__title">MTG WIKI ITALIA</h2>
          <p class="slide__desc">
            Vuoi scoprire tutto di tutto? <br> La wiki italiana di Magic &egrave; il posto giusto!
          </p>
          <div class="slide__cta">
            <a class="btn btn--teal" 
               target="_blank"
               rel="noopener noreferrer"
               href="https://magicthegathering.fandom.com/it/wiki/Magic:_the_Gathering_Wiki">Vai al sito
             </a>
          </div>
        </article>

        <!-- Slide 3 -->
        <article class="pager__slide slide-3" id="slide-3"
                 role="group" aria-roledescription="slide"
                 aria-label="Slide 3 di 3: Eventi"
                 data-bg-mobile="{{ "images/subhero/sh3-mobile.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
                 data-bg-desktop="{{ "images/subhero/sh3-desktop.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}">
          <h2 class="slide__title">PROSSIMI EVENTI</h2>
          <p class="slide__desc">
            Stiamo lavorando per il prossimo evento. <br> Rimanete sintonizzati!
          </p>
          <div class="slide__cta">
            <a class="btn btn--disabled1" target="_blank" rel="noopener noreferrer" href="#">Coming soon</a>
          </div>
        </article>

      </div>
    </div>

    <!-- Dots -->
    <div class="pager__dots" role="tablist" aria-label="Selettore slide">
      <button class="dot is-active" aria-current="true" aria-controls="slide-1" aria-label="Vai alla slide 1"></button>
      <button class="dot" aria-controls="slide-2" aria-label="Vai alla slide 2"></button>
      <button class="dot" aria-controls="slide-3" aria-label="Vai alla slide 3"></button>
    </div>

    <!-- Frecce (desktop only, nascoste su mobile via CSS/JS) -->
    <div class="pager__controls glass" aria-hidden="true">
      <button class="pager__arrow prev" type="button" aria-label="Slide precedente">&lsaquo;</button>
      <button class="pager__arrow next" type="button" aria-label="Slide successiva">&rsaquo;</button>
    </div>
  </section>
  <!-- <<< END SUB-HERO -->

  <!-- >>> START CARDS SECTION -->
  <section id="cards" class="cards" aria-labelledby="cards-title">
    <div class="cards__inner">
      <h2 id="cards-title" class="cards__title">Esplora</h2>
      
      <div class="cards__grid">
        {{/* Ultime 4 dal data archive: solo directory data/archive/items/*.yml */}}
        {{ $items := slice }}
        {{ with .Site.Data.archive.items }}
          {{ range $k, $v := . }}
            {{ if not $v.draft }}{{ $items = $items | append $v }}{{ end }}
          {{ end }}
        {{ end }}
        {{ $items = sort $items "date" "desc" }}
        {{ $items = first (cond (gt (len $items) 4) 4 (len $items)) $items }}

        {{ if gt (len $items) 0 }}
          {{ range $i, $it := $items }}
            {{ $isVideo := eq (lower $it.kind) "video" }}
            {{ $thumbURL := ("images/cards/fblthp_placeholder.webp" | absURL) }}
            {{ with $it.card }}
              {{ $c := . }}
              {{ if hasPrefix $c "http" }}
                {{ $thumbURL = $c }}
              {{ else }}
                {{ $thumbURL = ($c | absURL) }}
              {{ end }}
            {{ else }}
              {{ with $it.thumb }}
                {{ $t := . }}
                {{ if hasPrefix $t "http" }}
                  {{ $thumbURL = $t }}
                {{ else }}
                  {{ $thumbURL = ($t | absURL) }}
                {{ end }}
              {{ end }}
            {{ end }}
            {{ $over  := $it.overline }}
            {{ $tit   := $it.title }}
            {{ $desc  := $it.desc }}
            {{ $links := cond (isset $it "links") (sort $it.links "sort_order" "asc") (slice) }}
            {{ $prim  := where $links "primary" true }}
            {{ $purl  := "" }}
            {{ if gt (len $prim) 0 }}
              {{ $purl = (index $prim 0).href }}
            {{ else if gt (len $links) 0 }}
              {{ $purl = (index $links 0).href }}
            {{ end }}

            <article class="card {{ if $isVideo }}is-video{{ else }}is-content{{ end }}" data-kind="{{ if $isVideo }}video{{ else }}content{{ end }}">
              {{ if and $isVideo (ne $purl "") }}
                <a href="{{ $purl }}" target="_blank" rel="noopener noreferrer" class="card__link-wrapper" aria-label="Guarda video: {{ $tit }}">
                  <div class="card__media">
                    <img
                      class="card__img"
                      src="{{ $thumbURL }}"
                      sizes="(max-width: 479px) 320px, (max-width: 1023px) 340px, 360px"
                      width="1280" height="720"
                      decoding="async"
                      loading="{{ if eq $i 0 }}eager{{ else }}lazy{{ end }}"
                      fetchpriority="{{ if eq $i 0 }}high{{ else }}low{{ end }}"
                      alt="{{ if $tit }}{{ $tit }}{{ else }}Immagine contenuto{{ end }}"
                    />
                    <span class="card__media-overlay"></span>
                    <span class="card__play" aria-hidden="true">
                      <svg class="card__play-icon" viewBox="0 0 100 100" aria-hidden="true" focusable="false">
                        <circle class="card__play-circle" cx="50" cy="50" r="34" />
                        <polygon class="card__play-tri" points="35,32 65,50 35,68" />
                      </svg>
                    </span>
                  </div>
                  <div class="card__body">
                    {{ with $over }}<p class="card__overline">{{ . }}</p>{{ end }}
                    <h3 class="card__title">{{ $tit }}</h3>
                    {{ with $desc }}<p class="card__desc">{{ . }}</p>{{ end }}
                  </div>
                </a>
              {{ else }}
                <div class="card__media">
                  <img
                    class="card__img"
                    src="{{ $thumbURL }}"
                    sizes="(max-width: 479px) 320px, (max-width: 1023px) 340px, 360px"
                    width="1280" height="720"
                    decoding="async"
                    loading="{{ if eq $i 0 }}eager{{ else }}lazy{{ end }}"
                    fetchpriority="{{ if eq $i 0 }}high{{ else }}low{{ end }}"
                    alt="{{ if $tit }}{{ $tit }}{{ else }}Immagine contenuto{{ end }}"
                  />
                  <span class="card__media-overlay"></span>
                </div>
                <div class="card__body">
                  {{ with $over }}<p class="card__overline">{{ . }}</p>{{ end }}
                  <h3 class="card__title">{{ $tit }}</h3>
                  {{ with $desc }}<p class="card__desc">{{ . }}</p>{{ end }}
                </div>
                <div class="card__actions">
                  {{ if ne $purl "" }}
                    <a class="btn btn--tealstroke"
                       href="{{ $purl }}"
                       target="_blank" rel="noopener noreferrer">Apri</a>
                  {{ else }}
                    <a class="btn btn--tealstroke" href="{{ "/archive/" | absURL }}">Altro</a>
                  {{ end }}
                </div>
              {{ end }}
            </article>
          {{ end }}
        {{ else }}
          <!-- Nessun item: CTA coerente con legacy -->
          <div class="card card--empty">
            <div class="card__body">
              <h3 class="card__title">Nessun contenuto</h3>
              <p class="card__desc">Contenuti in arrivo.</p>
            </div>
            <div class="card__actions">
              <a class="btn btn--tealstroke" href="{{ "/archive/" | absURL }}">Altro</a>
            </div>
          </div>
        {{ end }}
      </div>
    </div>
  </section>
  <!-- <<< END CARDS -->

  <!-- >>> START PORTAL -->
  <section id="portal" class="portal" aria-labelledby="portal-title">
  <div class="portal__inner">
    <h2 id="portal-title" class="portal__title">Vai all'archivio</h2>
    <p class="portal__intro">
      Naviga tra i nostri contenuti: video, decklist e molto altro.
    </p>
    <p class="portal__sub">Viaggia tra le storie che plasmano Magic.</p>
  </div>
  </section>
  <!-- <<< END PORTAL --->

  <!-- >>> START LINKS -->
  <section class="links" aria-labelledby="links-title">
  <div class="links__inner">
    <h2 id="links-title" class="links__title">Amici, Partners &amp; Links</h2>

    <div class="links__carousel">
      <ul class="links__track" role="list">
        <li class="link-card link-card--full">
          <a class="link-card__link" href="https://www.ebay.it/" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/ebay_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="eBay" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta"></div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://linktr.ee/boosemtg" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/boose_logo.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="B&#216;&#216;SE MTG" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">B&#216;&#216;SE MTG</span>
              <span class="link-card__copy">Friends &amp; Games</span>
            </div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://www.facebook.com/Multiverseofgames/" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/multiverse_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="Multiverse of Games" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">Multiverse of Games</span>
              <span class="link-card__copy">Friendly LGS</span>
            </div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://www.domenicocava.com/" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/cava_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="Domenico Cava" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">Domenico Cava</span>
              <span class="link-card__copy">Illustrator for MtG</span>
            </div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://archidekt.com/search/decks?ownerUsername=Mtg.derrick" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/derrick_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="mtg.Derrick" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">MtG Derrick</span>
              <span class="link-card__copy">Liste Commander</span>
            </div>
          </a>
        </li>

      </ul>
    </div>
  </div>
  </section>
  <!-- <<< END LINKS -->

  <!-- >>> START CONTACTS -->
  <section id="contacts" class="contacts" aria-labelledby="contacts-title">
  <div class="contacts__inner">
    <h2 id="contacts-title" class="contacts__title">Chi siamo</h2>
    <p class="contacts__intro">
      Siamo Vincenzo e Francesco, amici appassionati di Magic: The Gathering, Dungeons & Dragons, giochi da tavolo e videogiochi.
    </p>
    <p class="contacts__sub">Restiamo in contatto</p>

    <ul class="contacts__list" role="list">
      <li>
        <a class="contact" href="https://www.tiktok.com/@eventhorizonmtg" target="_blank" rel="noopener noreferrer" aria-label="TikTok" title="TikTok">
          <span class="contact__icon icon-tiktok" aria-hidden="true"></span>
        </a>
      </li>
      <li>
        <a class="contact" href="https://www.instagram.com/eventhorizon.mtg" target="_blank" rel="noopener noreferrer" aria-label="Instagram" title="Instagram">
          <span class="contact__icon icon-instagram" aria-hidden="true"></span>
        </a>
      </li>
      <li>
        <a class="contact" href="https://www.youtube.com/@EventHorizonMtG" target="_blank" rel="noopener noreferrer" aria-label="YouTube" title="YouTube">
          <span class="contact__icon icon-youtube" aria-hidden="true"></span>
        </a>
      </li>
      <li>
        <a class="contact" href="https://t.me/eventhorizonmtg" target="_blank" rel="noopener noreferrer" aria-label="Telegram" title="Telegram">
          <span class="contact__icon icon-telegram" aria-hidden="true"></span>
        </a>
      </li>
      <li>
        <a class="contact" href="https://discord.com/invite/tQrbzhUa4k" target="_blank" rel="noopener noreferrer" aria-label="Discord" title="Discord">
          <span class="contact__icon icon-discord" aria-hidden="true"></span>
        </a>
      </li>
      <li>
        <a class="contact" href="mailto:eventhorizon@growupnetwork.it" aria-label="Email" title="Email">
          <span class="contact__icon icon-mail" aria-hidden="true"></span>
        </a>
      </li>
    </ul>
  </div>
  </section>
  <!-- <<< END CONTACTS -->


</main>
{{ end }}


